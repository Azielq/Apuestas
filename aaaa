CREATE TABLE `PaymentTransaction` (
  `TransactionId` int NOT NULL AUTO_INCREMENT,
  `UserId` int NOT NULL,
  `PaymentMethodId` int NOT NULL,
  `Amount` decimal(10,2) NOT NULL,
  `TransactionType` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL,
  `Status` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL,
  `CreatedAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `UpdatedAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
  PRIMARY KEY (`TransactionId`),
  KEY `FK_PaymentTransaction_PaymentMethod` (`PaymentMethodId`),
  KEY `IX_PaymentTransaction_UserAccount_CreatedAt` (`UserId`,`CreatedAt` DESC),
  KEY `IX_PaymentTransaction_Status` (`Status`),
  CONSTRAINT `FK_PaymentTransaction_PaymentMethod` FOREIGN KEY (`PaymentMethodId`) REFERENCES `PaymentMethod` (`PaymentMethodId`),
  CONSTRAINT `FK_PaymentTransaction_UserAccount` FOREIGN KEY (`UserId`) REFERENCES `UserAccount` (`UserId`),
  CONSTRAINT `CK_PaymentTransaction_Amount` CHECK ((`Amount` >= 0)),
  CONSTRAINT `CK_PaymentTransaction_Status` CHECK ((`Status` in (_utf8mb4'pending',_utf8mb4'completed',_utf8mb4'failed'))),
  CONSTRAINT `CK_PaymentTransaction_Type` CHECK ((`TransactionType` in (_utf8mb4'deposit',_utf8mb4'withdrawal')))
) ENGINE=InnoDB AUTO_INCREMENT=55 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
